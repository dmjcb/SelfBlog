---
title: "python函数与装饰器"
date: 2021-12-18
categories: [python]
tags: [python]
excerpt: "函数"
---

> [Python装饰器深度解析](https://zhuanlan.zhihu.com/p/45458873)

## 函数

### 形参实参

- 定义函数时创建形参

```py
def add(a: int, b: int, c: int, d: int)-> int:
    return a + b + c + d
```

- 调用函数时使用实参

```py
add(1, 2, 3, 4)
```

### 变长参数

#### *args

将参数打包成 tuple 调用

```py
def fun(*args: tuple)->None:
    print(args)
    print(type(args))

fun(1)
fun(1, 'A')
```

![](/assets/image/20241128_233024.jpg)

#### **kwargs

将参数打包成 dict 给函数调用, 参数位置必须是`*args`, `**kwargs`顺序, 否则程序报错

```py
def fun(**kwargs: dict)->None:
    print(kwargs)
    print(type(kwargs))

fun(name = 'WANG')
fun(num = '20209902', name = 'TI', age = 18)
```

![](/assets/image/20241128_233415.jpg)



### 参数解包

#### *实参

在序列类型的参数前添加`*`, 会将序列中的元素依次作为参数传递

```py
def func(a, b):
    print(a, b)

p1 = (1, 2)
p2 = [4, 5]

func(*p1)
func(*p2)
```

#### **实参

对一个字典进行解包操作, 字典的key对应函数的形参, 字典的value对应实参

```py
def func(a, b):
    print(a, b)

p = {'a': 11, 'b': 22}

func(**p)
```

## 装饰器

### 概念

装饰器是可以在不影响原有函数结构上, 给函数添加额外功能的函数

```py
def timer(func):
    def wrapper(*args, **kwargs):
        ...
        func(*args, **kwargs)
        ...
    # 返回内层函数引用
    return wrapper

@timer
def add(a, b):
    print(a + b)
```

#### 高阶函数

接受函数为入参, 或者把函数作为结果返回的函数. 后者称之为嵌套函数

#### 闭包

指延伸了作用域的函数, 其中包含函数定义体中引用、但是不在定义体中定义的非全局变量. 简单来说就是嵌套函数引用了外层函数的变量

### @

Python的语法糖,作用类似

```py
# 返回timer.<locals>.wrapper函数引用
add = timer(add)
add(1, 2)
```

- 显示每个函数的运行时间

```py
import time

def runtime(func):
    def wrapper(*args, **kwargs):
        start_time = time.time()
        func()
        end_time = time.time()
        print(end_time - start_time)
    return wrapper

@runtime
def func():
    num = 0
    for i in range(1234356):
        num += i
    print(num)

func()
```

![](/assets/image/20241128_233545.jpg)

- 显示当前运行函数的函数名

```py
def defname(func):
    def wrapper(*args, **kwargs):
        print("def name is :%s" % func.__name__)
        return func(*args, **kwargs)
    return wrapper

@defname
def func_a():
    print("aaaaaaa")

@defname
def func_b():
    print("bbbbbbb")

func_a()
func_b()
```

![](/assets/image/20241128_233616.jpg)