---
title: "C_C++内存空间"
date: 2021-02-13
categories: [c_c++]
tags: [c_c++]
excerpt: "内存空间"
---

由C_C++编译程序占用内存分布如下

## 区域

### 代码段(Code Segment/Text Segment)

#### 位置

通常位于虚拟内存空间较低地址部分

#### 内容

存放程序执行时机器指令, 即函数二进制代码

内容通常只读, 以防止意外修改

### 数据段(Data Segment)

#### 初始化数据段(.data)

包含程序中被明确初始化全局变量、全局静态变量和局部静态变量、常量(如字符串常量)

在程序编译时就已经分配好空间, 并在程序启动前由操作系统初始化

#### 未初始化数据区(.bss)

称为bss区(Block Started by Symbol), 存放程序中未初始化全局变量和静态变量

在程序编译时分配空间, 在程序启动前由操作系统初始化为0(或NULL)

该部分在程序运行时才需要被初始化因此不占用磁盘空间

#### 文字常量区

存放常量字符串, 程序结束后由系统释放

### 栈区(Stack)

用于存放函数的局部变量、函数参数、返回地址等

每当调用新函数时都会在栈上创建一个新栈帧(Stack Frame), 函数返回时栈帧被自动销毁

#### 特点

栈内存由编译器自动分配和释放

栈内存是连续内存区域, 其生长方向是向内存地址减小方向(即向下生长)

栈内存大小有限, 若申请栈内存超过剩余空间, 将会导致溢出错误

### 堆区(Heap)

用于程序运行时动态内存分配

程序员可通过malloc、calloc、realloc等函数(在C中)或new、new[]运算符(在C++中)来申请堆内存, 并通过free或delete、delete[]来释放

#### 特点

堆内存生命周期由程序员控制, 堆内存是不连续内存区域, 由操作系统用链表来管理空闲内存地址