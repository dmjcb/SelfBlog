---
title: "游戏-L4D2-服务器搭建"
date: 2022-01-11
categories: [游戏, L4D2]
tags: [游戏]
excerpt: "L4D2服务器搭建"
---

> - [cm2network/squad 说明文档](https://hub.docker.com/r/cm2network/squad/)

# L4D2服务器搭建

## Docker部署

### 创建 

拉取镜像

```sh
docker pull cm2network/steamcmd
```

![](/Resource/Imgur/20241110_124729.jpg)

创建容器

```sh
docker run -itd --net="host" --name=L4d2Server cm2network/steamcmd
```

### 匿名登陆

进入容器

```sh
docker exec -it L4d2Server bash
```

```sh
./steamcmd.sh
```

等待进度条结束

![](/Resource/Imgur/20241110_125124.jpg)

匿名登录

```sh
login anonymous
```

![](/Resource/Imgur/20241110_125241.jpg)

### 下载服务端

```sh
app_update 222860 validate
```

很大, 约10个G左右

![](/Resource/Imgur/20241110_125458.jpg)

![](/Resource/Imgur/20241110_130600.jpg)

### 配置

退出登录

```sh
exit
```

编辑/Steam/steamapps/common/Left 4 Dead 2 Dedicated Server/left4dead2/cfg/server.cfg

![](/Resource/Imgur/20241110_131901.jpg)

- server.cfg

创建一个 Steam组并将 Steam组的 ID 填入 sv_steamgroup, 将服务器设为 Steam组私有, 这样的话只有 Steam组成员可以在游戏内看到服务器

```c
hostname "dmjcb"            // 游戏服务器名
sv_steamgroup "123456"      // Steam组号
sv_steamgroup_exclusive "1" // 是否将服务器设为Steam组私有
sv_consistency "0"          // 是否允许装了不同mod的人进入服务器
sv_tags "hidden"            // 隐藏服务器(防止Ddos攻击)
sv_cheats 1               // 是否允许作弊
sv_region "255"             // 服务器地区, 255表示全球
```

![](/Resource/Imgur/20241110_132103.jpg)

### 建立地图

进入/Steam/steamapps/common/Left 4 Dead 2 Dedicated Server/

```sh
./srcds_run -game left4dead2 -insecure +map [地图名] -maxplayers 8 -condebug +exec server.cfg -nomaster
```

- 建立死亡中心

```sh
./srcds_run -game left4dead2 -insecure +map c1m1_hotel -maxplayers 8 -condebug +exec server.cfg -nomaster
```

![](/Resource/Imgur/20241110_132423.jpg)

![](/Resource/Imgur/20241110_133005.jpg)

代表服务器启动成功

L4D2 默认端口 `27015`, 可以自己设置其他端口运行

#### 使用三方地图

将三方地图文件拷贝到/Steam/steamapps/common/Left 4 Dead 2 Dedicated Server/left4dead2/addons路径下

![](/Resource/Imgur/20241113_231058.jpg)

使用广州增城地图

```sh
./srcds_run -game left4dead2 -insecure +map zc_m1 -maxplayers 8 -condebug +exec server.cfg -nomaster
```

## 连接

![](/Resource/Imgur/20241110_134219.jpg)

进入游戏L4D2控制台, 输入

```sh
connect [IP]:27015
```

![](/Resource/Imgur/20241110_133332.jpg)

![](/Resource/Imgur/20241110_133420.jpg)

下图可见Server端已经出现Client端信息

![](/Resource/Imgur/20241110_133448.jpg)

![](/Resource/Imgur/20241110_133459.jpg)