<!--
 * @Description: 
 * @Version: 1.0
 * @Author: dmjcb
 * @Email:  
 * @Date: 2021-11-06 13:27:01
 * @LastEditors: dmjcb
 * @LastEditTime: 2024-07-07 01:57:50
-->

# 变量

## 声明与定义

### 声明

声明用来告诉编译器变量的名称和类型, 而不分配内存

```c++
extern int var;

typedef int INT;

struct Node;
```

- extern

extern 变量类型 变量名,表示 变量 在别的文件中已经定义.提示编译器遇到此变量时在其它模块中寻找其定义

### 定义

定义是给变量分配内存, 可以为变量赋初值

全局变量或静态变量初始值为0, 局部变量初始化为随机值

C/C++ 中变量的声明和定义区别并不大, 定义和声明往往是同时发生

变量定义时, 会根据变量类型分配空间

```c++
// 声明 + 定义, 变量名为 value, 类型为 int, 分配 4 字节的内存(不同编译器会有差异)
int value;

// 声明 + 定义
struct Node {
    int left;
    int right;
}; 

// 如果给变量赋值, 即使有extern也是定义
extern int b = 10;
```

### 规则

- 变量在使用前就要被定义或者声明

- 程序中, 变量可以**声明多次**, 只能**定义一次**

- 定义会分配存储空间, 而声明不会

## 类型

### 全局变量

```c
int gValue = 0xFF;
```

从静态存储区域分配, 作用域为全局

多个源文件程序, 全局变量只需在一个文件中定义, 其他文件中通过`extern`声明

生命周期与整个程序同在, 从程序开始到结束一直起作用

### 全局静态变量

```c
static int g_value = 0xFF;
```

从静态存储区域分配, 作用域只在定义它的源文件内, 其他源文件不能使用

生命周期与整个程序同在, 从程序开始到结束一直起作用

### 局部变量

```c
void func() {
    int i = 3;
}

// 错误
printf("%d\n", i);
```

从栈上分配, 作用域只在局部函数内, 出了函数局部变量就不再起作用

生命周期只和该函数同在

### 局部静态变量

```c
void func() {
    static int i = 3;
}

// 错误
printf("%d\n", i);
```

从静态存储区域分配, 作用域只在定义它的函数内可见, 出了该函数就不可见

生命周期与整个程序同在, 从程序开始到结束一直起作用